

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyspod.spod_base &mdash; PySPOD 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> PySPOD
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PySPOD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pyspod.spod_base</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyspod.spod_base</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Base module for the SPOD:</span>
<span class="sd">	- `fit` and `predict` methods must be implemented in inherited classes</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="c1"># Import standard Python packages</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">psutil</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.special</span> <span class="k">as</span> <span class="nn">sc</span>

<span class="c1"># Import custom Python packages</span>
<span class="kn">import</span> <span class="nn">pyspod.postprocessing</span> <span class="k">as</span> <span class="nn">post</span>

<span class="c1"># Current, parent and file paths</span>
<span class="n">CWD</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">CF</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">CFD</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">CF</span><span class="p">)</span>
<span class="n">BYTE_TO_GB</span> <span class="o">=</span> <span class="mf">9.3132257461548e-10</span>



<div class="viewcode-block" id="SPOD_base"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base">[docs]</a><span class="k">class</span> <span class="nc">SPOD_base</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Spectral Proper Orthogonal Decomposition base class.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">data_handler</span><span class="p">,</span> <span class="n">variables</span><span class="p">):</span>

		<span class="c1"># store mandatory parameters in class</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_nt</span>   <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;nt&#39;</span><span class="p">]</span>	<span class="c1"># number of time-frames</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_xdim</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;xdim&#39;</span><span class="p">]</span> <span class="c1"># number of spatial dimensions</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_nv</span>   <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;nv&#39;</span><span class="p">]</span>	<span class="c1"># number of variables</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dt</span>   <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span>	<span class="c1"># time-step</span>

		<span class="c1"># type of data management</span>
		<span class="c1"># - data_handler: read type online</span>
		<span class="c1"># - not data_handler: data is entirely pre-loaded</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_params</span> <span class="o">=</span> <span class="n">params</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_data_handler</span> <span class="o">=</span> <span class="n">data_handler</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="n">variables</span>
		<span class="k">if</span> <span class="n">data_handler</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
			<span class="n">X</span> <span class="o">=</span> <span class="n">data_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">t_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nv</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdim</span> <span class="o">+</span> <span class="mi">2</span><span class="p">):</span>
				<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">def</span> <span class="nf">data_handler</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">t_0</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">variables</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">t_0</span> <span class="o">==</span> <span class="n">t_end</span><span class="p">:</span> <span class="n">ti</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span><span class="n">t_0</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
				<span class="k">else</span>           <span class="p">:</span> <span class="n">ti</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span><span class="n">t_end</span><span class="p">)</span>
				<span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ti</span><span class="p">,</span><span class="o">...</span><span class="p">,:]</span>
				<span class="k">return</span> <span class="n">d</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_data_handler</span> <span class="o">=</span> <span class="n">data_handler</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
			<span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">t_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nv</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdim</span> <span class="o">+</span> <span class="mi">2</span><span class="p">):</span>
				<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>


		<span class="c1"># get data dimensions and store in class</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_nx</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dim</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_xdim</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_xshape</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

		<span class="c1"># Determine whether data is real-valued or complex-valued-valued</span>
		<span class="c1"># to decide on one- or two-sided spectrum. If &quot;opts.isreal&quot; is</span>
		<span class="c1"># not set, determine from data</span>
		<span class="k">if</span> <span class="s1">&#39;isreal&#39;</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_isrealx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="p">[</span><span class="s1">&#39;isreal&#39;</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_isrealx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

		<span class="c1"># get default spectral estimation parameters and options</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weights</span><span class="p">,</span> \
		<span class="bp">self</span><span class="o">.</span><span class="n">_n_overlap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_DFT</span><span class="p">,</span> \
		<span class="bp">self</span><span class="o">.</span><span class="n">_n_blocks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_mean</span><span class="p">,</span> \
		<span class="bp">self</span><span class="o">.</span><span class="n">_mean_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span><span class="p">,</span> \
		<span class="bp">self</span><span class="o">.</span><span class="n">_n_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_parameters</span><span class="p">(</span> \
				<span class="n">isrealx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_isrealx</span><span class="p">,</span>
				<span class="n">params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_params</span>
		<span class="p">)</span>

		<span class="c1"># determine correction for FFT window gain</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_winWeight</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_window</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>

		<span class="c1"># get default for confidence interval</span>
		<span class="k">if</span> <span class="s1">&#39;conf_level&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_conf_level</span> <span class="o">=</span> <span class="mf">0.95</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_xi2_upper</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_blocks</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf_level</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_xi2_lower</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">gammaincinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_blocks</span><span class="p">,</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_conf_level</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_eigs_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_freq</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_blocks</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex_&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_conf_interval</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_eigs_c</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_conf_interval</span> <span class="o">=</span> <span class="kc">False</span>

		<span class="c1"># get default for normalization Boolean</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_normvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normvar&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>

		<span class="c1"># create folder to save results</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_savefft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savefft&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_save_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savedir&#39;</span><span class="p">,</span><span class="n">CWD</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_save_dir_blocks</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_dir</span><span class="p">,</span><span class="s1">&#39;nfft&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_DFT</span><span class="p">)</span><span class="o">+</span>\
			<span class="s1">&#39;_novlp&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_overlap</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_nblks&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_blocks</span><span class="p">))</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_dir_blocks</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_save_dir_blocks</span><span class="p">)</span>

		<span class="c1"># compute approx problem size (assuming double)</span>
		<span class="n">pb_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nv</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">BYTE_TO_GB</span>

		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DATA MATRIX DIMENSIONS&#39;</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------&#39;</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Problem size          : &#39;</span><span class="p">,</span> <span class="n">pb_size</span><span class="p">,</span> <span class="s1">&#39;GB. (double)&#39;</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;data matrix dimensions:        &#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Make sure that first column of data matrix &#39;</span>
			  <span class="s1">&#39;is time and last column is number of variables. &#39;</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First column dimension: </span><span class="si">{}</span><span class="s1"> must correspond to &#39;</span>
			  <span class="s1">&#39;number of time snapshots.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Last column dimension: </span><span class="si">{}</span><span class="s1"> must correspond to &#39;</span>
			  <span class="s1">&#39;number of variables.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------&#39;</span><span class="p">)</span>



	<span class="c1"># basic getters</span>
	<span class="c1"># ---------------------------------------------------------------------------</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">save_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the directory where results are saved.</span>

<span class="sd">		:return: path to directory where results are saved.</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_dir</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the shape of the data matrix.</span>

<span class="sd">		:return: shape of the data matrix.</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dim</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the shape of the data matrix.</span>

<span class="sd">		:return: shape of the data matrix.</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">nt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of time-steps of the data matrix.</span>

<span class="sd">		:return: the number of time-steps of the data matrix.</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">nx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of spatial points of the data matrix.</span>

<span class="sd">		:return: the number of spatial points [dim1:] of the data matrix.</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nx</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">nv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of variables of the data matrix.</span>

<span class="sd">		:return: the number of variables of the data matrix.</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nv</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">xdim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of spatial dimensions of the data matrix.</span>

<span class="sd">		:return: number of spatial dimensions of the data matrix.</span>
<span class="sd">		:rtype: tuple(int,)</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdim</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">xshape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the spatial shape of the data matrix.</span>

<span class="sd">		:return: spatial shape of the data matrix.</span>
<span class="sd">		:rtype: tuple(int,)</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xshape</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">n_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of frequencies.</span>

<span class="sd">		:return: the number of frequencies computed by the SPOD algorithm.</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_freq</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">freq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of modes.</span>

<span class="sd">		:return: the number of modes computed by the SPOD algorithm.</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">dt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the time-step.</span>

<span class="sd">		:return: the time-step used by the SPOD algorithm.</span>
<span class="sd">		:rtype: double</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dt</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the variable list.</span>

<span class="sd">		:return: the variable list used.</span>
<span class="sd">		:rtype: list or strings</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">eigs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the eigenvalues of the SPOD matrix.</span>

<span class="sd">		:return: the eigenvalues from the eigendecomposition the SPOD matrix.</span>
<span class="sd">		:rtype: numpy.ndarray</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eigs</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">n_modes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of modes.</span>

<span class="sd">		:return: the number of modes computed by the SPOD algorithm.</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_modes</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">n_modes_saved</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the number of modes.</span>

<span class="sd">		:return: the number of modes computed by the SPOD algorithm.</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_modes_saved</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">modes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the dictionary containing the path to the SPOD modes saved.</span>

<span class="sd">		:return: the dictionary containing the path to the SPOD modes saved.</span>
<span class="sd">		:rtype: dict</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modes</span>

	<span class="c1"># ---------------------------------------------------------------------------</span>



	<span class="c1"># parser</span>
	<span class="c1"># ---------------------------------------------------------------------------</span>

	<span class="k">def</span> <span class="nf">parse_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isrealx</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>

		<span class="n">window</span>    <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;n_FFT&#39;</span><span class="p">]</span>
		<span class="n">weights</span>   <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weights&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
		<span class="n">n_overlap</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;n_overlap&#39;</span><span class="p">]</span>
		<span class="n">dt</span>        <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span>
		<span class="n">mean_type</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>

		<span class="c1"># determine default spectral estimation parameters:</span>
		<span class="c1"># - window size, and</span>
		<span class="c1"># - window type</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">window</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
				<span class="n">n_DFT</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="mi">10</span><span class="p">)))</span>
				<span class="n">window</span> <span class="o">=</span> <span class="n">SPOD_base</span><span class="o">.</span><span class="n">_hamming_window</span><span class="p">(</span><span class="n">n_DFT</span><span class="p">)</span>
				<span class="n">window_name</span> <span class="o">=</span> <span class="s1">&#39;hamming&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="s1">&#39;not recognized.&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span> <span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">window</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">n_DFT</span> <span class="o">=</span> <span class="n">window</span>
				<span class="n">window</span> <span class="o">=</span> <span class="n">SPOD_base</span><span class="o">.</span><span class="n">_hamming_window</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
				<span class="n">window_name</span> <span class="o">=</span> <span class="s1">&#39;hamming&#39;</span>
			<span class="k">elif</span> <span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">SPOD_base</span><span class="o">.</span><span class="n">_nextpow2</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">size</span><span class="p">))):</span>
				<span class="n">n_DFT</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">size</span>
				<span class="n">window_name</span> <span class="o">=</span> <span class="s1">&#39;user_specified&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">n_DFT</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">size</span>
				<span class="n">window_name</span> <span class="o">=</span> <span class="s1">&#39;user_specified&#39;</span>

		<span class="c1"># inner product weights</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nv</span><span class="p">):</span>
				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;parameter ``weights`` must &#39;</span>
								 <span class="s1">&#39;have the same spatial dimensions as data.&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nv</span><span class="p">):</span>
					<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nv</span><span class="p">),</span><span class="mi">1</span><span class="p">])</span>
				<span class="n">weights_name</span> <span class="o">=</span> <span class="s1">&#39;user-specified&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nv</span><span class="p">),</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">weights_name</span> <span class="o">=</span> <span class="s1">&#39;uniform&#39;</span>

		<span class="c1"># block overlap</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_overlap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">n_overlap</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
				<span class="n">n_overlap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n_DFT</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">n_overlap</span><span class="p">,</span> <span class="s1">&#39;not recognized.&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_overlap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">n_overlap</span> <span class="o">&gt;</span> <span class="n">n_DFT</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Overlap is too large&#39;</span><span class="p">)</span>

		<span class="c1"># number of blocks</span>
		<span class="n">n_blocks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">-</span> <span class="n">n_overlap</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_DFT</span> <span class="o">-</span> <span class="n">n_overlap</span><span class="p">));</span>

		<span class="c1"># test feasibility</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">n_DFT</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n_blocks</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Spectral estimation parameters not meaningful.&#39;</span><span class="p">)</span>

		<span class="c1"># cast relevant parameters into integers</span>
		<span class="n">n_DFT</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_DFT</span><span class="p">)</span>
		<span class="n">n_overlap</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_overlap</span><span class="p">)</span>
		<span class="n">n_blocks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_blocks</span><span class="p">)</span>

		<span class="c1"># select type of mean</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mean_type</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">mean_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;longtime&#39;</span><span class="p">:</span>
				<span class="c1"># split data into n_blocks chunks to maintain data consistency</span>
				<span class="n">split_block</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">//</span> <span class="n">n_blocks</span>
				<span class="n">split_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">%</span> <span class="n">n_blocks</span>
				<span class="n">x_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xshape</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nv</span><span class="p">,))</span>
				<span class="k">for</span> <span class="n">iBlk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_blocks</span><span class="p">):</span>
					<span class="n">lb</span> <span class="o">=</span> <span class="n">iBlk</span> <span class="o">*</span> <span class="n">split_block</span>
					<span class="n">ub</span> <span class="o">=</span> <span class="n">lb</span> <span class="o">+</span> <span class="n">split_block</span>
					<span class="n">x_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_handler</span><span class="p">(</span>
						<span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">t_0</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="n">ub</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
					<span class="n">x_sum</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
				<span class="n">x_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_handler</span><span class="p">(</span>
					<span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">t_0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">-</span><span class="n">split_res</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span>
					<span class="n">variables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
				<span class="n">x_sum</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
				<span class="n">x_mean</span> <span class="o">=</span> <span class="n">x_sum</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span>
				<span class="n">x_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_mean</span><span class="p">,(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nv</span><span class="p">)))</span>
				<span class="n">mean_name</span> <span class="o">=</span> <span class="s1">&#39;longtime&#39;</span>
			<span class="k">elif</span> <span class="n">mean_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;blockwise&#39;</span><span class="p">:</span>
				<span class="n">x_mean</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">mean_name</span> <span class="o">=</span> <span class="s1">&#39;blockwise&#39;</span>
			<span class="k">elif</span> <span class="n">mean_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
				<span class="n">x_mean</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">mean_name</span> <span class="o">=</span> <span class="s1">&#39;zero&#39;</span>
				<span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;No mean subtracted. Consider providing longtime mean.&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">mean_type</span><span class="p">,</span> <span class="s1">&#39;not recognized.&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mean_type</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
			<span class="n">x_mean</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
			<span class="n">mean_name</span> <span class="o">=</span> <span class="s1">&#39;user-specified&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">mean_type</span><span class="p">),</span> <span class="s1">&#39;data type not recognized. &#39;</span><span class="p">,</span>
							 <span class="s1">&#39;parameter ``mean`` can either be a str or a numpy.ndarray&#39;</span><span class="p">)</span>

		<span class="c1"># obtain frequency axis</span>
		<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_DFT</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">n_DFT</span>
		<span class="k">if</span> <span class="n">isrealx</span><span class="p">:</span>
			<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_DFT</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_DFT</span> <span class="o">/</span> <span class="n">dt</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">n_DFT</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
				<span class="n">freq</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n_DFT</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n_DFT</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">freq</span><span class="p">[(</span><span class="n">n_DFT</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[(</span><span class="n">n_DFT</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
		<span class="n">n_freq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>

		<span class="c1"># display parameter summary</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SPOD parameters&#39;</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">isrealx</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spectrum type             : one-sided (real-valued signal)&#39;</span><span class="p">)</span>
		<span class="k">else</span>      <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spectrum type             : two-sided (complex-valued signal)&#39;</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of snaphots per block : &#39;</span><span class="p">,</span> <span class="n">n_DFT</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Block overlap             : &#39;</span><span class="p">,</span> <span class="n">n_overlap</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of blocks             : &#39;</span><span class="p">,</span> <span class="n">n_blocks</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Windowing fct. (time)     : &#39;</span><span class="p">,</span> <span class="n">window_name</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Weighting fct. (space)    : &#39;</span><span class="p">,</span> <span class="n">weights_name</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean                      : &#39;</span><span class="p">,</span> <span class="n">mean_name</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time-step                 : &#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of Frequencies     : &#39;</span><span class="p">,</span> <span class="n">n_freq</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------&#39;</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">window</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">n_overlap</span><span class="p">,</span> <span class="n">n_DFT</span><span class="p">,</span> <span class="n">n_blocks</span><span class="p">,</span> <span class="n">x_mean</span><span class="p">,</span> <span class="n">mean_name</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">n_freq</span>

	<span class="c1"># ---------------------------------------------------------------------------</span>



	<span class="c1"># getters with arguments</span>
	<span class="c1"># ---------------------------------------------------------------------------</span>

<div class="viewcode-block" id="SPOD_base.find_nearest_freq"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.find_nearest_freq">[docs]</a>	<span class="k">def</span> <span class="nf">find_nearest_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq_required</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">freq</span><span class="p">:</span>
				<span class="n">freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span>
		<span class="n">nearest_freq</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">find_nearest_freq</span><span class="p">(</span><span class="n">freq_required</span><span class="o">=</span><span class="n">freq_required</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">nearest_freq</span><span class="p">,</span> <span class="n">idx</span></div>

<div class="viewcode-block" id="SPOD_base.find_nearest_coords"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.find_nearest_coords">[docs]</a>	<span class="k">def</span> <span class="nf">find_nearest_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">xi</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">find_nearest_coords</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">data_space_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xdim</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">xi</span><span class="p">,</span> <span class="n">idx</span></div>

<div class="viewcode-block" id="SPOD_base.get_modes_at_freq"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.get_modes_at_freq">[docs]</a>	<span class="k">def</span> <span class="nf">get_modes_at_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq_idx</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Modes not found. Consider running fit()&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_modes</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
			<span class="n">gb_memory_modes</span> <span class="o">=</span> <span class="n">freq_idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_modes_saved</span> <span class="o">*</span> \
				<span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="nb">complex</span><span class="p">())</span> <span class="o">*</span> <span class="n">BYTE_TO_GB</span>
			<span class="n">gb_vram_avail</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">BYTE_TO_GB</span>
			<span class="n">gb_sram_avail</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">swap_memory</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">BYTE_TO_GB</span>
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- RAM required for loading all modes ~&#39;</span><span class="p">,</span> <span class="n">gb_memory_modes</span><span class="p">,</span> <span class="s1">&#39;GB&#39;</span><span class="p">)</span>
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- Available RAM memory               ~&#39;</span><span class="p">,</span> <span class="n">gb_vram_avail</span>  <span class="p">,</span> <span class="s1">&#39;GB&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">gb_memory_modes</span> <span class="o">&gt;=</span> <span class="n">gb_vram_avail</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Not enough RAM memory to load modes stored, &#39;</span>
								 <span class="s1">&#39;for all frequencies.&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">m</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">get_mode_from_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_modes</span><span class="p">[</span><span class="n">freq_idx</span><span class="p">])</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Modes must be a dictionary&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">m</span></div>

<div class="viewcode-block" id="SPOD_base.get_data"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.get_data">[docs]</a>	<span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_0</span><span class="p">,</span> <span class="n">t_end</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Get the original input data.</span>

<span class="sd">		:return: the matrix that contains the original snapshots.</span>
<span class="sd">		:rtype: numpy.ndarray</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_handler</span><span class="p">:</span>
			<span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_handler</span><span class="p">(</span>
				<span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">t_0</span><span class="o">=</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="n">t_end</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nv</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdim</span> <span class="o">+</span> <span class="mi">2</span><span class="p">):</span>
				<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_end</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">X</span></div>

	<span class="c1"># ---------------------------------------------------------------------------</span>



	<span class="c1"># static methods</span>
	<span class="c1"># ---------------------------------------------------------------------------</span>

	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">_are_blocks_present</span><span class="p">(</span><span class="n">n_blocks</span><span class="p">,</span> <span class="n">n_freq</span><span class="p">,</span> <span class="n">saveDir</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Checking if blocks are already present ...&#39;</span><span class="p">)</span>
		<span class="n">all_blocks_exist</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">iBlk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_blocks</span><span class="p">):</span>
			<span class="n">all_freq_exist</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">for</span> <span class="n">iFreq</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_freq</span><span class="p">):</span>
				<span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">saveDir</span><span class="p">,</span>
					<span class="s1">&#39;fft_block</span><span class="si">{:04d}</span><span class="s1">_freq</span><span class="si">{:04d}</span><span class="s1">.npy&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iBlk</span><span class="p">,</span><span class="n">iFreq</span><span class="p">))</span>
				<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
					<span class="n">all_freq_exist</span> <span class="o">=</span> <span class="n">all_freq_exist</span> <span class="o">+</span> <span class="mi">1</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">all_freq_exist</span> <span class="o">==</span> <span class="n">n_freq</span><span class="p">):</span>
				<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;block &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iBlk</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n_blocks</span><span class="p">)</span><span class="o">+</span>\
					<span class="s1">&#39; is present in: &#39;</span><span class="p">,</span> <span class="n">saveDir</span><span class="p">)</span>
				<span class="n">all_blocks_exist</span> <span class="o">=</span> <span class="n">all_blocks_exist</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="k">if</span> <span class="n">all_blocks_exist</span> <span class="o">==</span> <span class="n">n_blocks</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... all blocks are present - loading from storage.&#39;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... blocks are not present - proceeding to compute them.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">_nextpow2</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">			Returns the exponents for the smallest powers</span>
<span class="sd">			of 2 that satisfy 2^p &gt;= abs(a)</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">while</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
			<span class="n">v</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">p</span>
			<span class="n">p</span> <span class="o">+=</span> <span class="mi">1</span>
		<span class="k">return</span> <span class="n">p</span>

	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">_hamming_window</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">			Standard Hamming window of length N</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">window</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.54</span> <span class="o">-</span> <span class="mf">0.46</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
		<span class="k">return</span> <span class="n">window</span>

	<span class="c1"># ---------------------------------------------------------------------------</span>



	<span class="c1"># abstract methods</span>
	<span class="c1"># ---------------------------------------------------------------------------</span>

<div class="viewcode-block" id="SPOD_base.fit"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.fit">[docs]</a>	<span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Abstract method to fit the data matrices.</span>
<span class="sd">		Not implemented, it has to be implemented in subclasses.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
			<span class="s1">&#39;Subclass must implement abstract method </span><span class="si">{}</span><span class="s1">.fit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span></div>

<div class="viewcode-block" id="SPOD_base.predict"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.predict">[docs]</a>	<span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		Abstract method to predict the next time frames.</span>
<span class="sd">		Not implemented, it has to be implemented in subclasses.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
			<span class="s1">&#39;Subclass must implement abstract method </span><span class="si">{}</span><span class="s1">.predict&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span></div>

	<span class="c1"># ---------------------------------------------------------------------------</span>



	<span class="c1"># plotting methods</span>
	<span class="c1"># ---------------------------------------------------------------------------</span>

<div class="viewcode-block" id="SPOD_base.plot_eigs"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.plot_eigs">[docs]</a>	<span class="k">def</span> <span class="nf">plot_eigs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
				  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
				  <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
				  <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
				  <span class="n">equal_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
				  <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">post</span><span class="o">.</span><span class="n">plot_eigs</span><span class="p">(</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">show_axes</span><span class="o">=</span><span class="n">show_axes</span><span class="p">,</span>
			<span class="n">equal_axes</span><span class="o">=</span><span class="n">equal_axes</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="SPOD_base.plot_eigs_vs_frequency"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.plot_eigs_vs_frequency">[docs]</a>	<span class="k">def</span> <span class="nf">plot_eigs_vs_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
				  			   <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
				  			   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
							   <span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
							   <span class="n">yticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
				  			   <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
				  			   <span class="n">equal_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
							   <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
				  			   <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span>
		<span class="n">post</span><span class="o">.</span><span class="n">plot_eigs_vs_frequency</span><span class="p">(</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">yticks</span><span class="o">=</span><span class="n">yticks</span><span class="p">,</span>
			<span class="n">show_axes</span><span class="o">=</span><span class="n">show_axes</span><span class="p">,</span> <span class="n">equal_axes</span><span class="o">=</span><span class="n">equal_axes</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
			<span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="SPOD_base.plot_eigs_vs_period"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.plot_eigs_vs_period">[docs]</a>	<span class="k">def</span> <span class="nf">plot_eigs_vs_period</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
							<span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
							<span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
							<span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
							<span class="n">yticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
							<span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
							<span class="n">equal_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
							<span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
							<span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span>
		<span class="n">post</span><span class="o">.</span><span class="n">plot_eigs_vs_period</span><span class="p">(</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">eigs</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">yticks</span><span class="o">=</span><span class="n">yticks</span><span class="p">,</span>
			<span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">show_axes</span><span class="o">=</span><span class="n">show_axes</span><span class="p">,</span> <span class="n">equal_axes</span><span class="o">=</span><span class="n">equal_axes</span><span class="p">,</span>
			<span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="SPOD_base.plot_2D_modes_at_frequency"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.plot_2D_modes_at_frequency">[docs]</a>	<span class="k">def</span> <span class="nf">plot_2D_modes_at_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
								   <span class="n">freq_required</span><span class="p">,</span>
								   <span class="n">freq</span><span class="p">,</span>
								   <span class="n">vars_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
								   <span class="n">modes_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
								   <span class="n">x1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								   <span class="n">x2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								   <span class="n">fftshift</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								   <span class="n">imaginary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								   <span class="n">plot_max</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								   <span class="n">coastlines</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								   <span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								   <span class="n">yticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								   <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
								   <span class="n">equal_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								   <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">post</span><span class="o">.</span><span class="n">plot_2D_modes_at_frequency</span><span class="p">(</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="p">,</span> <span class="n">freq_required</span><span class="o">=</span><span class="n">freq_required</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span> <span class="n">vars_idx</span><span class="o">=</span><span class="n">vars_idx</span><span class="p">,</span>
			<span class="n">modes_idx</span><span class="o">=</span><span class="n">modes_idx</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span> <span class="n">fftshift</span><span class="o">=</span><span class="n">fftshift</span><span class="p">,</span> <span class="n">imaginary</span><span class="o">=</span><span class="n">imaginary</span><span class="p">,</span>
			<span class="n">plot_max</span><span class="o">=</span><span class="n">plot_max</span><span class="p">,</span> <span class="n">coastlines</span><span class="o">=</span><span class="n">coastlines</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">yticks</span><span class="o">=</span><span class="n">yticks</span><span class="p">,</span>
			<span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">equal_axes</span><span class="o">=</span><span class="n">equal_axes</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="SPOD_base.plot_2D_mode_slice_vs_time"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.plot_2D_mode_slice_vs_time">[docs]</a>	<span class="k">def</span> <span class="nf">plot_2D_mode_slice_vs_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
								   <span class="n">freq_required</span><span class="p">,</span>
								   <span class="n">freq</span><span class="p">,</span>
								   <span class="n">vars_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
								   <span class="n">modes_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
								   <span class="n">x1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								   <span class="n">x2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								   <span class="n">max_each_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								   <span class="n">fftshift</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								   <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
								   <span class="n">equal_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								   <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">post</span><span class="o">.</span><span class="n">plot_2D_mode_slice_vs_time</span><span class="p">(</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="p">,</span> <span class="n">freq_required</span><span class="o">=</span><span class="n">freq_required</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span> <span class="n">vars_idx</span><span class="o">=</span><span class="n">vars_idx</span><span class="p">,</span>
			<span class="n">modes_idx</span><span class="o">=</span><span class="n">modes_idx</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span> <span class="n">max_each_mode</span><span class="o">=</span><span class="n">max_each_mode</span><span class="p">,</span>
			<span class="n">fftshift</span><span class="o">=</span><span class="n">fftshift</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">equal_axes</span><span class="o">=</span><span class="n">equal_axes</span><span class="p">,</span>
			<span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="SPOD_base.plot_3D_modes_slice_at_frequency"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.plot_3D_modes_slice_at_frequency">[docs]</a>	<span class="k">def</span> <span class="nf">plot_3D_modes_slice_at_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
								   		 <span class="n">freq_required</span><span class="p">,</span>
								   		 <span class="n">freq</span><span class="p">,</span>
								         <span class="n">vars_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
								         <span class="n">modes_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
								         <span class="n">x1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								         <span class="n">x2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								         <span class="n">x3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								         <span class="n">slice_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
								         <span class="n">slice_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								         <span class="n">fftshift</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								         <span class="n">imaginary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								         <span class="n">plot_max</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
										 <span class="n">coastlines</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								         <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
								         <span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								         <span class="n">yticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
								         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
								         <span class="n">equal_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
								         <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">post</span><span class="o">.</span><span class="n">plot_3D_modes_slice_at_frequency</span><span class="p">(</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="p">,</span> <span class="n">freq_required</span><span class="o">=</span><span class="n">freq_required</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span>
			<span class="n">vars_idx</span><span class="o">=</span><span class="n">vars_idx</span><span class="p">,</span> <span class="n">modes_idx</span><span class="o">=</span><span class="n">modes_idx</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span>
			<span class="n">x3</span><span class="o">=</span><span class="n">x3</span><span class="p">,</span> <span class="n">slice_dim</span><span class="o">=</span><span class="n">slice_dim</span><span class="p">,</span> <span class="n">slice_id</span><span class="o">=</span><span class="n">slice_id</span><span class="p">,</span> <span class="n">fftshift</span><span class="o">=</span><span class="n">fftshift</span><span class="p">,</span>
			<span class="n">imaginary</span><span class="o">=</span><span class="n">imaginary</span><span class="p">,</span> <span class="n">plot_max</span><span class="o">=</span><span class="n">plot_max</span><span class="p">,</span> <span class="n">coastlines</span><span class="o">=</span><span class="n">coastlines</span><span class="p">,</span>
			<span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">yticks</span><span class="o">=</span><span class="n">yticks</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
			<span class="n">equal_axes</span><span class="o">=</span><span class="n">equal_axes</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="SPOD_base.plot_mode_tracers"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.plot_mode_tracers">[docs]</a>	<span class="k">def</span> <span class="nf">plot_mode_tracers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
						  <span class="n">freq_required</span><span class="p">,</span>
						  <span class="n">freq</span><span class="p">,</span>
						  <span class="n">coords_list</span><span class="p">,</span>
						  <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
						  <span class="n">vars_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
						  <span class="n">modes_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
						  <span class="n">fftshift</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
						  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
						  <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
						  <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">post</span><span class="o">.</span><span class="n">plot_mode_tracers</span><span class="p">(</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="p">,</span> <span class="n">freq_required</span><span class="o">=</span><span class="n">freq_required</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">,</span> <span class="n">coords_list</span><span class="o">=</span><span class="n">coords_list</span><span class="p">,</span>
			<span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">vars_idx</span><span class="o">=</span><span class="n">vars_idx</span><span class="p">,</span> <span class="n">modes_idx</span><span class="o">=</span><span class="n">modes_idx</span><span class="p">,</span> <span class="n">fftshift</span><span class="o">=</span><span class="n">fftshift</span><span class="p">,</span>
			<span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="SPOD_base.plot_2D_data"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.plot_2D_data">[docs]</a>	<span class="k">def</span> <span class="nf">plot_2D_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
					 <span class="n">time_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
					 <span class="n">vars_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
					 <span class="n">x1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
					 <span class="n">x2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
					 <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
					 <span class="n">coastlines</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
					 <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
					 <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">max_time_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">time_idx</span><span class="p">)</span>
		<span class="n">post</span><span class="o">.</span><span class="n">plot_2D_data</span><span class="p">(</span>
			<span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">t_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="n">max_time_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
			<span class="n">time_idx</span><span class="o">=</span><span class="n">time_idx</span><span class="p">,</span> <span class="n">vars_idx</span><span class="o">=</span><span class="n">vars_idx</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span>
			<span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">coastlines</span><span class="o">=</span><span class="n">coastlines</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
			<span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="SPOD_base.plot_data_tracers"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.plot_data_tracers">[docs]</a>	<span class="k">def</span> <span class="nf">plot_data_tracers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
						  <span class="n">coords_list</span><span class="p">,</span>
						  <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
						  <span class="n">time_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
						  <span class="n">vars_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
						  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
						  <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
						  <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">post</span><span class="o">.</span><span class="n">plot_data_tracers</span><span class="p">(</span>
			<span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">t_0</span><span class="o">=</span><span class="n">time_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_end</span><span class="o">=</span><span class="n">time_limits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
			<span class="n">coords_list</span><span class="o">=</span><span class="n">coords_list</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">time_limits</span><span class="o">=</span><span class="n">time_limits</span><span class="p">,</span>
			<span class="n">vars_idx</span><span class="o">=</span><span class="n">vars_idx</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span>
			<span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

	<span class="c1"># ---------------------------------------------------------------------------</span>



	<span class="c1"># Generate animations</span>
	<span class="c1"># ---------------------------------------------------------------------------</span>
<div class="viewcode-block" id="SPOD_base.generate_2D_data_video"><a class="viewcode-back" href="../../index.html#pyspod.spod_base.SPOD_base.generate_2D_data_video">[docs]</a>	<span class="k">def</span> <span class="nf">generate_2D_data_video</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
					 	       <span class="n">time_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
					 	       <span class="n">vars_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
						       <span class="n">sampling</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
					 	       <span class="n">x1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
					 	       <span class="n">x2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
						       <span class="n">coastlines</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
						       <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
					 	       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;data_video.mp4&#39;</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		See method implementation in the postprocessing module.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">post</span><span class="o">.</span><span class="n">generate_2D_data_video</span><span class="p">(</span>
			<span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">t_0</span><span class="o">=</span><span class="n">time_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_end</span><span class="o">=</span><span class="n">time_limits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
			<span class="n">time_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">time_limits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">vars_idx</span><span class="o">=</span><span class="n">vars_idx</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="n">sampling</span><span class="p">,</span>
			<span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span> <span class="n">coastlines</span><span class="o">=</span><span class="n">coastlines</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span><span class="p">,</span>
			<span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Copyright 2020-2025, SIA
      <span class="lastupdated">
        Last updated on Nov 05, 2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>